CREATE TABLE employees1 (
    ename VARCHAR(50),
    dept_name VARCHAR(50),
    designation VARCHAR(50),
    salary INT,
    date_of_join DATE
);
INSERT INTO employees1(ename, dept_name, designation, salary, date_of_join)
VALUES
('KARAN', 'ACCOUNTING', 'DIRECTOR', 50000, '2012-11-17'),
('FARAH', 'RESEARCH', 'ANALYST', 30000, '1991-12-03'),
('SCINDIA', 'RESEARCH', 'ANALYST', 30000, '2002-12-09'),
('JOY', 'RESEARCH', 'MANAGER', 29750, '2011-04-02'),
('BHASKAR', 'SALES', 'MANAGER', 28500, '1999-05-01'),
('CHANDER', 'ACCOUNTING', 'MANAGER', 24500, '2000-06-09'),
('ANIL', 'SALES', 'SALESMAN', 16000, '1991-02-20'),
('TOMAR', 'SALES', 'SALESMAN', 15000, '2001-09-08'),
('MILIND', 'ACCOUNTING', 'CLERK', 13000, '2002-01-23'),
('SAXENA', 'SALES', 'SALESMAN', 12500, '1999-09-28'),
('TOMAR', 'SALES', 'SALESMAN', 14500, '1997-02-22'),
('ANAND', 'RESEARCH', 'CLERK', 11000, '1993-01-12'),
('GEORGE', 'SALES', 'CLERK', 9500, '1990-12-03'),
('SURESH', 'RESEARCH', 'CLERK', 8000, '1992-12-17');


select * from employees1;

(A)
SELECT ename 
FROM employees1
WHERE salary < 20000;

OUTPUT:
ANIL
TOMAR
MILIND
SAXENA
TOMAR

------------------------------------------------------------------------------------------------------------------------------------------------
(B)
SELECT *
FROM employees1
WHERE dept_name = 'SALES' AND designation = 'MANAGER';

OUTPUT:
BHASKAR	SALES	MANAGER	28500	1999-05-01
-------------------------------------------------------------------------------------------------------------------------------------------------
(C)
SELECT *
FROM employees1
WHERE ename LIKE 'S%';

OUTPUT:
SCINDIA	RESEARCH	ANALYST	30000	2002-12-09
SAXENA	SALES	   SALESMAN	12500	1999-09-28
SURESH	RESEARCH	CLERK	8000	1992-12-17
--------------------------------------------------------------------------------------------------------------------------------------------------
(D)
SELECT COUNT(*) AS total_employees
FROM employees1
WHERE dept_name = 'RESEARCH';
OUTPUT:
5
---------------------------------------------------------------------------------------------------------------------------------------------------
(E)
SELECT *
FROM employees1
WHERE date_of_join > '2010-01-01';
OUTPUT: 
KARAN	ACCOUNTING	DIRECTOR	50000	2012-11-17
JOY	    RESEARCH	MANAGER	    29750	2011-04-02
--------------------------------------------------------------------------------------------------------------------------------------------------
(F)
SELECT COUNT(*) AS employee_count
FROM employees1
WHERE salary BETWEEN 8000 AND 125000;
OUTPUT:
14
---------------------------------------------------------------------------------------------------------------------------------------------------
(G)
SELECT *
FROM employees1
ORDER BY ename;
OUTPUT:
ANAND	RESEARCH	CLERK	11000	1993-01-12
ANIL	SALES	  SALESMAN	16000	1991-02-20
BHASKAR	SALES	  MANAGER	28500	1999-05-01
CHANDER	ACCOUNTING	MANAGER	24500	2000-06-09
FARAH	RESEARCH	ANALYST	30000	1991-12-03
GEORGE	SALES	CLERK	9500	1990-12-03
JOY	RESEARCH	MANAGER	29750	2011-04-02
KARAN	ACCOUNTING	DIRECTOR	50000	2012-11-17
MILIND	ACCOUNTING	CLERK	13000	2002-01-23
SAXENA	SALES	SALESMAN	12500	1999-09-28
SCINDIA	RESEARCH	ANALYST	30000	2002-12-09
SURESH	RESEARCH	CLERK	8000	1992-12-17
TOMAR	SALES	SALESMAN	15000	2001-09-08
TOMAR	SALES	SALESMAN	14500	1997-02-22
------------------------------------------------------------------------------------------------------------------------------------------------------
(H)
SELECT *
FROM employees1
WHERE designation = 'SALESMAN' AND date_of_join > '1990-08-01';
OUTPUT:
ANIL	SALES	SALESMAN	16000	1991-02-20
TOMAR	SALES	SALESMAN	15000	2001-09-08
SAXENA	SALES	SALESMAN	12500	1999-09-28
TOMAR	SALES	SALESMAN	14500	1997-02-22
------------------------------------------------------------------------------------------------------------------------------------------------------
(I)
SELECT *
FROM employees1
WHERE designation = 'CLERK';
OUTPUT:
MILIND	ACCOUNTING	CLERK	13000	2002-01-23
ANAND	RESEARCH	CLERK	11000	1993-01-12
GEORGE	SALES   	CLERK	 9500   1990-12-03
SURESH	RESEARCH	CLERK	8000	1992-12-17
------------------------------------------------------------------------------------------------------------------------------------------------------
(J)
SELECT COUNT(*) AS salesman_count
FROM employees1
WHERE designation = 'SALESMAN' AND dept_name = 'SALES';
OUTPUT:
4
------------------------------------------------------------------------------------------------------------------------------------------------------
(K)
SELECT COUNT(*) AS total_employees
FROM employees1;
OUTPUT:
14
------------------------------------------------------------------------------------------------------------------------------------------------------
(L)
SELECT *
FROM employees1
WHERE date_of_join BETWEEN '1997-01-01' AND '2010-12-31';
OUTPUT:
SCINDIA	RESEARCH	ANALYST	30000	2002-12-09
BHASKAR	SALES	MANAGER	28500	1999-05-01
CHANDER	ACCOUNTING	MANAGER	24500	2000-06-09
TOMAR	SALES	SALESMAN	15000	2001-09-08
MILIND	ACCOUNTING	CLERK	13000	2002-01-23
SAXENA	SALES	SALESMAN	12500	1999-09-28
TOMAR	SALES	SALESMAN	14500	1997-02-22
-------------------------------------------------------------------------------------------------------------------------------------------------------
(M)
SELECT * 
FROM employees1
ORDER BY salary DESC;
OUTPUT:
KARAN	ACCOUNTING	DIRECTOR	50000	2012-11-17
FARAH	RESEARCH	ANALYST	30000	1991-12-03
SCINDIA	RESEARCH	ANALYST	30000	2002-12-09
JOY	    RESEARCH	MANAGER	29750	2011-04-02
BHASKAR	SALES	    MANAGER	28500	1999-05-01
CHANDER	ACCOUNTING	MANAGER	24500	2000-06-09
ANIL	SALES	   SALESMAN	16000	1991-02-20
TOMAR	SALES	   SALESMAN	15000	2001-09-08
TOMAR	SALES	   SALESMAN	14500	1997-02-22
MILIND	ACCOUNTING	CLERK	13000	2002-01-23
SAXENA	SALES	  SALESMAN	12500	1999-09-28
ANAND	RESEARCH	CLERK	11000	1993-01-12
GEORGE	SALES	   CLERK	9500	1990-12-03
SURESH	RESEARCH	CLERK	8000	1992-12-17
---------------------------------------------------------------------------------------------------------------------------------------------------------




QUESTION NUMBER 3
Table 1: DEPT
CREATE TABLE DEPT (
    DEPTNO NUMBER(2) NOT NULL,
    DNAME VARCHAR2(14),
    LOC VARCHAR2(13),
    PRIMARY KEY (DEPTNO)
);

Table 2: EMP
CREATE TABLE EMP (
    EMPNO NUMBER(4) NOT NULL,
    ENAME VARCHAR2(10),
    JOB VARCHAR2(9),
    MGR NUMBER(4),
    HIREDATE DATE,
    SAL NUMBER(7, 2),
    COMM NUMBER(7, 2),
    DEPTNO NUMBER(2),
    PRIMARY KEY (EMPNO),
    FOREIGN KEY (DEPTNO) REFERENCES DEPT(DEPTNO)
);

INSERT INTO DEPT (DEPTNO, DNAME, LOC)
VALUES 
(10, 'ACCOUNTING', 'NEW YORK'),
(20, 'RESEARCH', 'DALLAS'),
(30, 'SALES', 'CHICAGO'),
(40, 'OPERATIONS', 'BOSTON');

INSERT INTO EMP (EMPNO, ENAME, JOB, MGR, HIREDATE, SAL, COMM, DEPTNO)
VALUES
(7839, 'KING', 'PRESIDENT', NULL, '1981-11-17', 5000, NULL, 10),
(7566, 'JONES', 'MANAGER', 7839, '1981-04-02', 2975, NULL, 20),
(7698, 'BLAKE', 'MANAGER', 7839, '1981-05-01', 2850, NULL, 30),
(7782, 'CLARK', 'MANAGER', 7839, '1981-06-09', 2450, NULL, 10),
(7788, 'SCOTT', 'ANALYST', 7566, '1982-12-09', 3000, NULL, 20),
(7902, 'FORD', 'ANALYST', 7566, '1981-12-03', 3000, NULL, 20),
(7844, 'TURNER', 'SALESMAN', 7698, '1981-09-08', 1500, 0, 30),
(7654, 'MARTIN', 'SALESMAN', 7698, '1981-09-28', 1250, 1400, 30),
(7499, 'ALLEN', 'SALESMAN', 7698, '1981-02-20', 1600, 300, 30),
(7521, 'WARD', 'SALESMAN', 7698, '1981-02-22', 1450, 500, 30),
(7934, 'MILLER', 'CLERK', 7782, '1982-01-23', 1300, NULL, 10),
(7876, 'ADAMS', 'CLERK', 7788, '1983-01-12', 1100, NULL, 20),
(7900, 'JAMES', 'CLERK', 7698, '1981-12-03', 950, NULL, 30);

(1)
SELECT DISTINCT e1.EMPNO, e1.ENAME, e1.JOB
FROM EMP e1
WHERE e1.EMPNO IN (SELECT e2.MGR FROM EMP e2 WHERE e2.MGR IS NOT NULL);

OUTPUT:
7839	KING	PRESIDENT
7566	JONES	MANAGER
7698	BLAKE	MANAGER
7782	CLARK	MANAGER
7788	SCOTT	ANALYST
----------------------------------------------------------------------------------------------------------------------------------------------------

(2)
SELECT * 
FROM EMP
WHERE DEPTNO = 10
AND (SELECT COUNT(*) FROM EMP WHERE DEPTNO = 10) > 10;
OUTPUT:
This query will return no rows
-------------------------------------------------------------------------------------------------------------------------------------------------------
(3)
SELECT e1.ENAME AS Employee, 
       e2.ENAME AS Manager
FROM EMP e1
LEFT JOIN EMP e2 
ON e1.MGR = e2.EMPNO;
OUTPUT:
Employee Manager
KING	NULL
JONES	KING
BLAKE	KING
CLARK	KING
SCOTT	JONES
FORD	JONES
TURNER	BLAKE
MARTIN	BLAKE
ALLEN	BLAKE
WARD	BLAKE
MILLER	CLARK
ADAMS	SCOTT
JAMES	BLAKE
-----------------------------------------------------------------------------------------------------------------------------------------------------------
(4)
SELECT e1.ENAME AS Employee
FROM EMP e1
WHERE e1.EMPNO NOT IN (SELECT DISTINCT MGR FROM EMP WHERE MGR IS NOT NULL);

OUTPUT:
Employee
SCOTT
FORD
TURNER
MARTIN
ALLEN
WARD
MILLER
ADAMS
JAMES
------------------------------------------------------------------------------------------------------------------------------------------------------------
(5)
SELECT * 
FROM EMP
WHERE SAL > (SELECT MIN(SAL) FROM EMP WHERE DEPTNO = 20);
OUTPUT:
EMPNO	ENAME	JOB 	     MGR	HIREDATE	SAL 	COMM	DEPTNO
7839	KING	PRESIDENT	NULL	1981-11-17	5000	NULL	10
7566	JONES	MANAGER	    7839 	1981-04-02	2975	NULL	20
7698	BLAKE	MANAGER 	7839	1981-05-01	2850	NULL	30
7782	CLARK	MANAGER 	7839	1981-06-09	2450	NULL	10
7788	SCOTT	ANALYST 	7566	1982-12-09	3000	NULL	20
7902	FORD	ANALYST 	7566	1981-12-03	3000	NULL	20
7844	TURNER	SALESMAN    7698	1981-09-08	1500	0   	30
7654	MARTIN	SALESMAN	7698	1981-09-28	1250	1400	30
7499	ALLEN	SALESMAN	7698	1981-02-20	1600	300 	30
7521	WARD	SALESMAN	7698	1981-02-22	1450	500 	30
7934	MILLER	CLERK   	7782	1982-01-23	1300	NULL	10
---------------------------------------------------------------------------------------------------------------------------------------------------------
(6)
SELECT * 
FROM EMP
WHERE SAL > (SELECT MAX(SAL) FROM EMP WHERE JOB = 'MANAGER');
OUTPUT:
EMPNO	ENAME	JOB     	MGR 	HIREDATE	SAL 	COMM	DEPTNO
7839	KING	PRESIDENT 	NULL	1981-11-17	5000	NULL	10
7788	SCOTT	ANALYST 	7566	1982-12-09	3000	NULL	20
7902	FORD	ANALYST 	7566	1981-12-03	3000	NULL	20
------------------------------------------------------------------------------------------------------------------------------------------------------------
(7)
SELECT JOB, MAX(SAL) AS Highest_Salary
FROM EMP
GROUP BY JOB;

OUTPUT:

JOB     	Highest_Salary
PRESIDENT	5000
MANAGER 	2975
ANALYST 	3000
SALESMAN	1600
CLERK   	1300
-----------------------------------------------------------------------------------------------------------------------------------------------------------
(8)
SELECT e.*
FROM EMP e
JOIN (
    SELECT DEPTNO, MAX(HIREDATE) AS Latest_Hire_Date
    FROM EMP
    GROUP BY DEPTNO
) latest ON e.DEPTNO = latest.DEPTNO AND e.HIREDATE = latest.Latest_Hire_Date;

OUTPUT:
EMPNO	ENAME	JOB     	MGR 	HIREDATE	SAL 	COMM	DEPTNO
7839	KING	PRESIDENT	NULL	1981-11-17	5000	NULL	10
7788	SCOTT	ANALYST 	7566	1982-12-09	3000	NULL	20
7844	TURNER	SALESMAN	7698	1981-09-08	1500	0   	30
---------------------------------------------------------------------------------------------------------------------------------------------------------------
(9)
SELECT EXTRACT(YEAR FROM HIREDATE) AS Year, COUNT(*) AS Number_of_Employees
FROM EMP
GROUP BY EXTRACT(YEAR FROM HIREDATE)
ORDER BY Number_of_Employees DESC;

OUTPUT:
Year	Number_of_Employees
1981	5
1982	3
1983	1
------------------------------------------------------------------------------------------------------------------------------------------------------
(10)
SELECT DEPTNO, SUM(SAL + NVL(COMM, 0)) AS Total_Remuneration
FROM EMP
GROUP BY DEPTNO
ORDER BY Total_Remuneration DESC;

OUTPUT:
DEPTNO	Total_Remuneration
30  	9400
20  	9000
10  	8750
----------------------------------------------------------------------------------------------------------------------------------------------------------------
(11)
SELECT EMPNO, ENAME, JOB, HIREDATE, SAL, 
       CASE 
           WHEN HIREDATE = (SELECT MAX(HIREDATE) FROM EMP) 
           THEN '*' 
           ELSE '' 
       END AS Marker
FROM EMP;

OUTPUT:

EMPNO	ENAME	JOB     	HIREDATE	SAL 	Marker
7839	KING	PRESIDENT	1981-11-17	5000	
7788	SCOTT	ANALYST 	1982-12-09	3000	
7902	FORD	ANALYST 	1981-12-03	3000	
7934	MILLER	CLERK   	1982-01-23	1300	  *
----------------------------------------------------------------------------------------------------------------------------------------------------------------
(12)
SELECT EMPNO, ENAME, JOB, SAL, DEPTNO
FROM EMP e
WHERE SAL > (SELECT AVG(SAL) 
             FROM EMP 
             WHERE DEPTNO = e.DEPTNO);

OUTPUT:

EMPNO	ENAME	JOB     	SAL 	DEPTNO
7839	KING	PRESIDENT	5000	10
7566	JONES	MANAGER 	2975	20
7698	BLAKE	MANAGER 	2850	30
7788	SCOTT	ANALYST 	3000	20
7902	FORD	ANALYST 	3000	20
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
(13)
SELECT SAL
FROM (
    SELECT SAL, ROW_NUMBER() OVER (ORDER BY SAL DESC) AS rnk
    FROM EMP
) 
WHERE rnk = 3;

OUTPUT:
SAL
3000
-------------------------------------------------------------------------------------------------------------------------------------------------------------------------
(14)
SELECT EMPNO, ENAME, JOB, HIREDATE, SAL, DEPTNO, COUNT(*)
FROM EMP
GROUP BY EMPNO, ENAME, JOB, HIREDATE, SAL, DEPTNO
HAVING COUNT(*) > 1;

OUTPUT:
EMPNO	ENAME	JOB     	HIREDATE	SAL 	DEPTNO	COUNT(*)
7499	ALLEN	SALESMAN	1981-02-20	1600	30  	2
7844	TURNER	SALESMAN	1981-09-08	1500	30     	2
--------------------------------------------------------------------------------------------------------------------------------------------------------------------
(15)
SELECT ENAME, HIREDATE,
       FLOOR(MONTHS_BETWEEN(SYSDATE, HIREDATE) / 12) AS Years,
       MOD(MONTHS_BETWEEN(SYSDATE, HIREDATE), 12) AS Months
FROM EMP;

OUTPUT:
ENAME	HIREDATE	Years	Months
KING	1981-11-17	42  	10
SCOTT	1982-12-09	41  	9
FORD	1981-12-03	42  	9
------------------------------------------------------------------------------------------------------------------------------------------------------------------------
